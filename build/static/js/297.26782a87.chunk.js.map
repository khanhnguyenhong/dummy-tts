{"version":3,"file":"static/js/297.26782a87.chunk.js","mappings":"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","sources":["components/TTVFetcher.js"],"sourcesContent":["import React from \"react\";\nimport { isEmpty } from \"lodash\";\n\nconst TTVFetcher = () => {\n    // https://tangthuvien.net/get-4-chap?story_id=38060&sort_by_ttv=217\n    const [fetchedData, setFetchedData] = React.useState(\"\");\n    const [currentLink, setCurrentLink] = React.useState(\"\");\n    const [storyId, setStoryId] = React.useState(\"\");\n    const [chapter, setChapter] = React.useState(1);\n    const [isSneaking, setIsSneaking] = React.useState(false);\n    let history = {};\n\n    const getHistory = () => {\n        const historyString = localStorage.getItem('preTTVHistory');\n        if (historyString) {\n            try {\n                history = JSON.parse(historyString);\n            } catch (e) {\n                history = {};\n            }\n        }\n    }\n\n    const fetchData = (input = '') => {\n        const url = isEmpty(input) ? currentLink : input;\n        localStorage.setItem('preTTVLink', url);\n\n        getHistory();\n        localStorage.setItem('preTTVHistory', JSON.stringify({\n            ...history,\n            [storyId]: chapter\n        }));\n\n        setFetchedData(\"Fetching \" + url);\n        fetch(\"/api/fetch-data\", {\n            method: \"POST\",\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({\n                url,\n            }),\n        }).then(() => {\n            setFetchedData(\"Done\");\n        }).catch(() => {\n            setFetchedData(\"Error\");\n        });\n    }\n\n    const loadLink = () => {\n        const newLink = localStorage.getItem('preTTVLink');\n        setCurrentLink(newLink);\n        setCustomLinkData(newLink);\n    }\n\n    const retriveData = () => {\n        let xhttp = new XMLHttpRequest();\n        xhttp.onreadystatechange = function () {\n            if (this.readyState === 4 && this.status === 200) {\n                setFetchedData(this.responseText);\n            }\n        };\n        xhttp.open(\"GET\", \"/api/retrive-data\", true);\n        xhttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        xhttp.send();\n    }\n\n    const fetchHistoryFromServer = () => {\n        let xhttp = new XMLHttpRequest();\n        xhttp.onreadystatechange = function () {\n            if (this.readyState === 4 && this.status === 200) {\n                setFetchedData(this.responseText);\n            }\n        };\n        xhttp.open(\"GET\", \"/api/fetch-history\", true);\n        xhttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        xhttp.send();\n    }\n\n    const setCustomLinkData = (newLink) => {\n        const qs = require('qs');\n        const params = qs.parse(newLink.split('?')[1]);\n        console.log(params.story_id);\n        console.log(params.sort_by_ttv);\n        setStoryId(params.story_id);\n        setChapter(params.sort_by_ttv);\n    }\n\n    const onChangeCurrentLink = (e) => {\n        const newLink = e.target.value;\n        setCurrentLink(newLink);\n        setCustomLinkData(newLink);\n    }\n\n    const editLink = ({ newStoryId, newChapter }) => {\n        const newLink = `https://tangthuvien.net/get-4-chap?story_id=${newStoryId || storyId}&sort_by_ttv=${newChapter || chapter}`\n        setCurrentLink(newLink);\n    }\n\n    const onChangeStoryId = (e) => {\n        setStoryId(e.target.value);\n        editLink({\n            newStoryId: e.target.value\n        })\n    }\n\n    const onChangeChapter = (e) => {\n        setChapter(e.target.value);\n        editLink({\n            newChapter: e.target.value\n        })\n    }\n\n    const fetchNextChapters = (number) => {\n        const nextChapter = parseInt(chapter) + number;\n        setChapter(nextChapter);\n        editLink({\n            newChapter: nextChapter\n        })\n        const newLink = `https://tangthuvien.net/get-4-chap?story_id=${storyId}&sort_by_ttv=${nextChapter}`\n        fetchData(newLink);\n    }\n\n    return (\n        <div style={{ display: \"flex\", flexDirection: \"column\", width: \"300px\", margin: \"auto\" }}>\n            <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n                <button type=\"button\" onClick={loadLink}>\n                    Load Previous Link\n                </button>\n                <button type=\"button\" onClick={() => {\n                    getHistory()\n                    setFetchedData(JSON.stringify(history))\n                }}>\n                    Fetch History\n                </button>\n                <button type=\"button\" onClick={fetchHistoryFromServer}>\n                    Fetch History from Server\n                </button>\n            </div>\n\n            <textarea type=\"text\" placeholder=\"Url\" value={currentLink} onChange={onChangeCurrentLink} />\n            <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n                <input type=\"text\" placeholder=\"story_id\" value={storyId} onChange={onChangeStoryId} />\n                <input type=\"text\" placeholder=\"chapter\" value={chapter} onChange={onChangeChapter} />\n            </div>\n            <button type=\"button\" onClick={() => fetchData()}>\n                Fetch\n            </button>\n            <button type=\"button\" onClick={() => fetchNextChapters(4)}>\n                Fetch next 4 chapters\n            </button>\n            <button type=\"button\" onClick={retriveData}>\n                Show data\n            </button>\n            <button type=\"button\" onClick={() => setIsSneaking(!isSneaking)}>Sneak: {isSneaking ? 'Yes' : 'No'}</button>\n            <div style={{ maxHeight: \"400px\", overflow: \"auto\", color: (isSneaking && fetchedData?.length > 20) ? \"rgb(37, 38, 38)\" : \"gray\" }} dangerouslySetInnerHTML={{ __html: fetchedData }}>\n            </div>\n        </div >\n    )\n}\n\nexport default TTVFetcher"],"names":["TTVFetcher","fetchedData","setFetchedData","React","currentLink","setCurrentLink","storyId","setStoryId","chapter","setChapter","isSneaking","setIsSneaking","history","getHistory","historyString","localStorage","getItem","JSON","parse","e","fetchData","input","arguments","length","undefined","url","isEmpty","setItem","stringify","_objectSpread","fetch","method","headers","Accept","body","then","catch","setCustomLinkData","newLink","params","require","split","console","log","story_id","sort_by_ttv","editLink","_ref","newStoryId","newChapter","concat","_jsxs","style","display","flexDirection","width","margin","children","_jsx","type","onClick","loadLink","fetchHistoryFromServer","xhttp","XMLHttpRequest","onreadystatechange","this","readyState","status","responseText","open","setRequestHeader","send","placeholder","value","onChange","target","number","nextChapter","parseInt","fetchNextChapters","retriveData","maxHeight","overflow","color","dangerouslySetInnerHTML","__html"],"sourceRoot":""}